<!DOCTYPE html>
<html lang="id" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kasir - Rumah Makan Klaten Manokwari</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            box-sizing: border-box;
        }
        @media print {
            .no-print { display: none !important; }
            .print-only { display: block !important; }
            body { 
                margin: 0 !important; 
                padding: 0 !important; 
                font-size: 8px !important;
                background: white !important;
            }
            @page {
                size: 58mm auto;
                margin: 0;
            }
        }
        .receipt-paper {
            width: 58mm;
            font-family: 'Courier New', monospace;
            font-size: 8px;
            line-height: 1.1;
            margin: 0;
            padding: 2mm;
            box-sizing: border-box;
        }
        .receipt-preview {
            width: 58mm;
            font-family: 'Courier New', monospace;
            font-size: 9px;
            line-height: 1.0;
            margin: 0 auto;
            padding: 2mm;
            box-sizing: border-box;
        }
    </style>
</head>
<body class="h-full bg-gradient-to-br from-orange-50 to-red-50">
    <div class="min-h-full">
        <!-- Header -->
        <header class="bg-gradient-to-r from-orange-600 to-red-600 text-white shadow-lg">
            <div class="max-w-7xl mx-auto px-4 py-6">
                <div class="flex justify-between items-center">
                    <div>
                        <h1 class="text-3xl font-bold" id="headerBusinessName">üçΩÔ∏è Rumah Makan Klaten Manokwari</h1>
                        <p class="text-orange-100 mt-1" id="headerBusinessAddress">Sistem Kasir Digital</p>
                    </div>
                    <div class="text-right">
                        <div class="text-lg font-semibold" id="currentTime"></div>
                        <div class="text-orange-100">Kasir: <span id="headerCashierName">Admin</span></div>
                    </div>
                </div>
            </div>
        </header>

        <main class="max-w-7xl mx-auto px-4 py-6">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Menu Section -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl shadow-lg p-6">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-2xl font-bold text-gray-800">üìã Daftar Menu</h2>
                            <div class="flex space-x-2">
                                <button onclick="toggleEditMode()" id="editModeBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors">
                                    ‚úèÔ∏è Edit Menu
                                </button>
                                <div class="relative">
                                    <button onclick="toggleNavigationMenu()" id="navMenuBtn" class="bg-gray-600 hover:bg-gray-700 text-white px-4 py-2 rounded-lg font-medium transition-colors flex items-center">
                                        ‚ò∞ Menu
                                        <svg class="w-4 h-4 ml-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                        </svg>
                                    </button>
                                    <div id="navigationMenu" class="hidden absolute right-0 mt-2 w-56 bg-white rounded-lg shadow-lg border border-gray-200 z-10">
                                        <div class="py-2">
                                            <button onclick="openSettingsModal(); closeNavigationMenu()" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center">
                                                ‚öôÔ∏è Pengaturan Usaha
                                            </button>
                                            <button onclick="openFooterModal(); closeNavigationMenu()" class="w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 flex items-center">
                                                üìù Edit Footer Struk
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Menu Categories -->
                        <div class="mb-4">
                            <div class="flex justify-between items-center border-b">
                                <div class="flex space-x-2">
                                    <button onclick="showCategory('makanan')" class="category-btn px-4 py-2 font-medium border-b-2 border-orange-500 text-orange-600" data-category="makanan">
                                        üçõ Makanan
                                    </button>
                                    <button onclick="showCategory('minuman')" class="category-btn px-4 py-2 font-medium text-gray-500 hover:text-orange-600" data-category="minuman">
                                        ü•§ Minuman
                                    </button>
                                </div>
                                <div id="editModeActions" class="hidden space-x-2">
                                    <button onclick="openAddMenuModal()" class="bg-green-600 hover:bg-green-700 text-white px-3 py-1 rounded-lg text-sm font-medium transition-colors">
                                        ‚ûï Tambah Menu
                                    </button>
                                </div>
                            </div>
                        </div>

                        <!-- Menu Items -->
                        <div id="menuContainer" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                            <!-- Menu items will be populated by JavaScript -->
                        </div>
                    </div>
                </div>

                <!-- Order Section -->
                <div class="lg:col-span-1">
                    <div class="bg-white rounded-xl shadow-lg p-6 sticky top-6">
                        <h2 class="text-2xl font-bold text-gray-800 mb-6">üõí Pesanan</h2>
                        
                        <div id="orderItems" class="space-y-3 mb-6 max-h-64 overflow-y-auto">
                            <div class="text-center text-gray-500 py-8">
                                Belum ada pesanan
                            </div>
                        </div>

                        <div class="border-t pt-4">
                            <div class="space-y-2 mb-4">
                                <div class="flex justify-between items-center">
                                    <span>Subtotal:</span>
                                    <span id="subtotalAmount" class="text-gray-700">Rp 0</span>
                                </div>
                                <div class="flex justify-between items-center text-sm">
                                    <span>Pajak Pemda (10%):</span>
                                    <span id="taxAmount" class="text-gray-600">Rp 0</span>
                                </div>
                                <div class="flex justify-between items-center text-lg font-bold border-t pt-2">
                                    <span>Total:</span>
                                    <span id="totalAmount" class="text-orange-600">Rp 0</span>
                                </div>
                            </div>
                            
                            <div class="space-y-3">
                                <button onclick="clearOrder()" class="w-full bg-gray-500 hover:bg-gray-600 text-white py-3 rounded-lg font-medium transition-colors">
                                    üóëÔ∏è Hapus Semua
                                </button>
                                <button onclick="processPayment()" id="paymentBtn" class="w-full bg-green-600 hover:bg-green-700 text-white py-3 rounded-lg font-medium transition-colors disabled:bg-gray-300" disabled>
                                    üí≥ Bayar & Cetak Struk
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>

        <!-- Add/Edit Menu Modal -->
        <div id="addMenuModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4">
                <h3 class="text-xl font-bold mb-4" id="menuModalTitle">‚ûï Tambah Menu Baru</h3>
                
                <div class="space-y-4">
                    <div>
                        <label for="menuName" class="block text-sm font-medium text-gray-700 mb-1">Nama Menu</label>
                        <input type="text" id="menuName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan nama menu">
                    </div>
                    <div>
                        <label for="menuPrice" class="block text-sm font-medium text-gray-700 mb-1">Harga (Rp)</label>
                        <input type="number" id="menuPrice" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Masukkan harga" min="0">
                    </div>
                    <div>
                        <label for="menuCategory" class="block text-sm font-medium text-gray-700 mb-1">Kategori</label>
                        <select id="menuCategory" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500">
                            <option value="makanan">üçõ Makanan</option>
                            <option value="minuman">ü•§ Minuman</option>
                        </select>
                    </div>
                </div>
                
                <div class="flex space-x-3 mt-6">
                    <button onclick="closeAddMenuModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-medium transition-colors">
                        Batal
                    </button>
                    <button onclick="saveMenu()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg font-medium transition-colors">
                        üíæ Simpan
                    </button>
                </div>
            </div>
        </div>

        <!-- Settings Modal -->
        <div id="settingsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 max-w-md w-full mx-4">
                <h3 class="text-xl font-bold mb-4">‚öôÔ∏è Pengaturan Usaha</h3>
                
                <div class="space-y-4">
                    <div>
                        <label for="businessName" class="block text-sm font-medium text-gray-700 mb-1">Nama Usaha</label>
                        <input type="text" id="businessName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="Nama usaha">
                    </div>
                    <div>
                        <label for="businessAddress" class="block text-sm font-medium text-gray-700 mb-1">Alamat</label>
                        <input type="text" id="businessAddress" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="Alamat usaha">
                    </div>
                    <div>
                        <label for="businessPhone" class="block text-sm font-medium text-gray-700 mb-1">Telepon</label>
                        <input type="text" id="businessPhone" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="Nomor telepon">
                    </div>
                    <div>
                        <label for="cashierName" class="block text-sm font-medium text-gray-700 mb-1">Nama Kasir</label>
                        <input type="text" id="cashierName" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500" placeholder="Nama operator kasir">
                    </div>
                </div>
                
                <div class="flex space-x-3 mt-6">
                    <button onclick="closeSettingsModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-medium transition-colors">
                        Batal
                    </button>
                    <button onclick="saveSettings()" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white py-2 rounded-lg font-medium transition-colors">
                        üíæ Simpan
                    </button>
                </div>
            </div>
        </div>

        <!-- Footer Settings Modal -->
        <div id="footerModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 max-w-lg w-full mx-4">
                <h3 class="text-xl font-bold mb-4">üìù Edit Footer Struk</h3>
                
                <div class="space-y-4">
                    <div>
                        <label for="footerLine1" class="block text-sm font-medium text-gray-700 mb-1">Baris 1</label>
                        <input type="text" id="footerLine1" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Contoh: Terima Kasih">
                    </div>
                    <div>
                        <label for="footerLine2" class="block text-sm font-medium text-gray-700 mb-1">Baris 2</label>
                        <input type="text" id="footerLine2" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Contoh: Selamat Menikmati!">
                    </div>
                    <div>
                        <label for="footerLine3" class="block text-sm font-medium text-gray-700 mb-1">Baris 3 (Opsional)</label>
                        <input type="text" id="footerLine3" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500" placeholder="Contoh: Sampai jumpa lagi">
                    </div>
                    
                    <div class="bg-gray-50 p-4 rounded-lg">
                        <h4 class="text-sm font-medium text-gray-700 mb-2">üëÄ Preview Footer:</h4>
                        <div class="bg-white border rounded p-3 text-center text-sm font-mono">
                            <div id="footerPreviewLine1">Terima Kasih</div>
                            <div id="footerPreviewLine2">Selamat Menikmati!</div>
                            <div id="footerPreviewLine3" class="hidden"></div>
                        </div>
                    </div>
                    
                    <div class="text-xs text-gray-600">
                        <p><strong>üí° Tips:</strong></p>
                        <ul class="list-disc list-inside space-y-1">
                            <li>Gunakan teks singkat untuk hasil terbaik</li>
                            <li>Baris 3 bersifat opsional, kosongkan jika tidak diperlukan</li>
                            <li>Footer akan muncul di semua desain struk</li>
                        </ul>
                    </div>
                </div>
                
                <div class="flex space-x-3 mt-6">
                    <button onclick="resetFooterToDefault()" class="bg-orange-500 hover:bg-orange-600 text-white py-2 px-4 rounded-lg font-medium transition-colors">
                        üîÑ Reset Default
                    </button>
                    <button onclick="closeFooterModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-medium transition-colors">
                        Batal
                    </button>
                    <button onclick="saveFooterSettings()" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg font-medium transition-colors">
                        üíæ Simpan
                    </button>
                </div>
            </div>
        </div>

        <!-- Payment Modal -->
        <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 max-w-4xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <h3 class="text-xl font-bold mb-4">üí≥ Pembayaran & Preview Struk</h3>
                
                <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                    <!-- Payment Form -->
                    <div class="space-y-4">
                        <div>
                            <label for="totalPayment" class="block text-sm font-medium text-gray-700 mb-1">Total Bayar</label>
                            <input type="text" id="totalPayment" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100" readonly>
                        </div>
                        <div>
                            <label for="cashReceived" class="block text-sm font-medium text-gray-700 mb-1">Uang Diterima</label>
                            <input type="number" id="cashReceived" class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500" placeholder="Masukkan jumlah uang">
                        </div>
                        <div>
                            <label for="changeAmount" class="block text-sm font-medium text-gray-700 mb-1">Kembalian</label>
                            <input type="text" id="changeAmount" class="w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-100" readonly>
                        </div>
                        
                        <!-- Date and Time Controls -->
                        <div class="border-t pt-4">
                            <h4 class="text-sm font-medium text-gray-700 mb-3">üìÖ Tanggal & Waktu Transaksi</h4>
                            <div class="grid grid-cols-2 gap-3">
                                <div>
                                    <label for="transactionDate" class="block text-xs font-medium text-gray-600 mb-1">Tanggal</label>
                                    <input type="date" id="transactionDate" class="w-full px-2 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm">
                                </div>
                                <div>
                                    <label for="transactionTime" class="block text-xs font-medium text-gray-600 mb-1">Waktu</label>
                                    <input type="time" id="transactionTime" class="w-full px-2 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm">
                                </div>
                            </div>
                            <button onclick="resetDateTime()" class="mt-2 text-xs text-blue-600 hover:text-blue-800 underline">
                                üîÑ Reset ke waktu sekarang
                            </button>
                        </div>
                        
                        <div class="space-y-3 mt-6">
                            <div class="flex items-center justify-between p-3 bg-purple-50 rounded-lg mb-3">
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm font-medium">üé® Desain Struk:</span>
                                    <span id="currentDesign" class="text-sm text-purple-600 font-medium">Klasik</span>
                                </div>
                                <button onclick="openReceiptDesignModal()" class="bg-purple-600 hover:bg-purple-700 text-white px-3 py-1 rounded text-sm font-medium transition-colors">
                                    Pilih Desain
                                </button>
                            </div>
                            
                            <div class="flex items-center justify-between p-3 bg-blue-50 rounded-lg">
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm font-medium">üì∂ Printer Bluetooth:</span>
                                    <span id="printerStatus" class="text-sm text-gray-600">Tidak terhubung</span>
                                </div>
                                <button onclick="connectPrinter()" id="connectBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-3 py-1 rounded text-sm font-medium transition-colors">
                                    Hubungkan
                                </button>
                            </div>
                            
                            <div class="flex space-x-3">
                                <button onclick="closePaymentModal()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-medium transition-colors">
                                    Batal
                                </button>
                                <button onclick="printReceipt()" id="printBtn" class="flex-1 bg-green-600 hover:bg-green-700 text-white py-2 rounded-lg font-medium transition-colors disabled:bg-gray-300" disabled>
                                    üñ®Ô∏è Cetak Struk
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Receipt Preview -->
                    <div class="bg-gray-100 p-4 rounded-lg">
                        <h4 class="text-lg font-semibold mb-3 text-center">üìÑ Preview Struk</h4>
                        <div class="bg-white rounded border-2 border-dashed border-gray-300 receipt-preview">
                            <div class="text-center mb-1 leading-tight">
                                <div class="font-bold text-center" id="previewBusinessName">RUMAH MAKAN KLATEN MANOKWARI</div>
                                <div class="text-xs text-center" id="previewBusinessAddress">Jl. Contoh No. 123</div>
                                <div class="text-xs text-center" id="previewBusinessPhone">Telp: (0986) 123456</div>
                                <div class="border-b border-dashed my-1"></div>
                            </div>
                            
                            <div class="text-xs mb-1">
                                <div>No. Transaksi: <span id="previewTransactionId"></span></div>
                                <div>Tanggal: <span id="previewDate"></span></div>
                                <div>Waktu: <span id="previewTime"></span></div>
                                <div>Kasir: <span id="previewCashier">Admin</span></div>
                                <div class="border-b border-dashed my-1"></div>
                            </div>

                            <div id="previewItems" class="text-xs mb-1" style="line-height: 0.8;">
                                <!-- Items will be populated -->
                            </div>

                            <div class="border-b border-dashed my-1"></div>
                            <div class="text-xs">
                                <div class="flex justify-between">
                                    <span>Subtotal:</span>
                                    <span id="previewSubtotal">Rp 0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Pajak Pemda (10%):</span>
                                    <span id="previewTax">Rp 0</span>
                                </div>
                                <div class="flex justify-between font-bold">
                                    <span>TOTAL:</span>
                                    <span id="previewTotal">Rp 0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Bayar:</span>
                                    <span id="previewPaid">Rp 0</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Kembali:</span>
                                    <span id="previewChange">Rp 0</span>
                                </div>
                            </div>

                            <div class="text-center text-xs mt-1 leading-tight">
                                <div>Terima Kasih</div>
                                <div>Selamat Menikmati!</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Receipt Design Selection Modal -->
        <div id="receiptDesignModal" class="fixed inset-0 bg-black bg-opacity-50 hidden items-center justify-center z-50">
            <div class="bg-white rounded-xl p-6 max-w-5xl w-full mx-4 max-h-[90vh] overflow-y-auto">
                <h3 class="text-xl font-bold mb-4">üé® Pilih Desain Struk</h3>
                
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                    <!-- Design 1: Classic -->
                    <div class="border-2 border-gray-300 rounded-lg p-3 hover:border-blue-500 cursor-pointer" onclick="selectReceiptDesign('classic')">
                        <h4 class="font-bold text-center mb-2 text-blue-600">üìÑ Klasik</h4>
                        <div class="bg-white border rounded receipt-preview text-xs">
                            <div class="text-center font-bold">RUMAH MAKAN KLATEN</div>
                            <div class="text-center text-xs">Jl. Contoh No. 123</div>
                            <div class="border-b border-dashed my-1"></div>
                            <div>No: 240101001</div>
                            <div>Tanggal: 01/01/2024</div>
                            <div class="border-b border-dashed my-1"></div>
                            <div>Nasi Gudeg</div>
                            <div class="flex justify-between">
                                <span>1 x Rp 15.000</span>
                                <span>Rp 15.000</span>
                            </div>
                            <div class="border-b border-dashed my-1"></div>
                            <div class="flex justify-between font-bold">
                                <span>TOTAL:</span>
                                <span>Rp 16.500</span>
                            </div>
                            <div class="text-center mt-1">Terima Kasih</div>
                        </div>
                        <div class="text-center mt-1">
                            <span class="text-xs text-gray-600">Sederhana dan bersih</span>
                        </div>
                    </div>

                    <!-- Design 2: Modern -->
                    <div class="border-2 border-gray-300 rounded-lg p-3 hover:border-green-500 cursor-pointer" onclick="selectReceiptDesign('modern')">
                        <h4 class="font-bold text-center mb-2 text-green-600">‚ú® Modern</h4>
                        <div class="bg-white border rounded receipt-preview text-xs">
                            <div class="text-center font-bold bg-gray-100 p-1">üçΩÔ∏è RUMAH MAKAN KLATEN</div>
                            <div class="text-center text-xs">üìç Jl. Contoh No. 123</div>
                            <div class="border-b-2 border-gray-400 my-1"></div>
                            <div class="flex justify-between">
                                <span>üìã No:</span>
                                <span>240101001</span>
                            </div>
                            <div class="border-b-2 border-gray-400 my-1"></div>
                            <div class="bg-gray-50 p-1">
                                <div>üçõ Nasi Gudeg</div>
                                <div class="flex justify-between">
                                    <span>1 x Rp 15.000</span>
                                    <span>Rp 15.000</span>
                                </div>
                            </div>
                            <div class="border-b-2 border-gray-400 my-1"></div>
                            <div class="flex justify-between font-bold bg-gray-100 p-1">
                                <span>üí∞ TOTAL:</span>
                                <span>Rp 16.500</span>
                            </div>
                            <div class="text-center mt-1">üôè Terima Kasih</div>
                        </div>
                        <div class="text-center mt-1">
                            <span class="text-xs text-gray-600">Emoji dan highlight</span>
                        </div>
                    </div>

                    <!-- Design 3: Elegant -->
                    <div class="border-2 border-gray-300 rounded-lg p-3 hover:border-purple-500 cursor-pointer" onclick="selectReceiptDesign('elegant')">
                        <h4 class="font-bold text-center mb-2 text-purple-600">üëë Elegan</h4>
                        <div class="bg-white border rounded receipt-preview text-xs">
                            <div class="text-center">
                                <div class="font-bold">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
                                <div class="font-bold">RUMAH MAKAN KLATEN</div>
                                <div class="font-bold">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
                            </div>
                            <div class="text-center text-xs">Jl. Contoh No. 123</div>
                            <div class="text-center">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
                            <div class="text-center">
                                <div>Transaksi: 240101001</div>
                                <div>01/01/2024 - 12:00</div>
                            </div>
                            <div class="text-center">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
                            <div>Nasi Gudeg Klaten</div>
                            <div class="flex justify-between">
                                <span>1 x 15.000</span>
                                <span>15.000</span>
                            </div>
                            <div class="text-center">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
                            <div class="flex justify-between font-bold">
                                <span>TOTAL BAYAR</span>
                                <span>16.500</span>
                            </div>
                            <div class="text-center mt-1">~ Terima Kasih ~</div>
                        </div>
                        <div class="text-center mt-1">
                            <span class="text-xs text-gray-600">Border dekoratif</span>
                        </div>
                    </div>

                    <!-- Design 4: Minimalis -->
                    <div class="border-2 border-gray-300 rounded-lg p-3 hover:border-indigo-500 cursor-pointer" onclick="selectReceiptDesign('minimalist')">
                        <h4 class="font-bold text-center mb-2 text-indigo-600">‚ö™ Minimalis</h4>
                        <div class="bg-white border rounded receipt-preview text-xs">
                            <div class="text-center font-bold text-lg">RM KLATEN</div>
                            <div class="text-center text-xs mb-2">Jl. Contoh No. 123</div>
                            <div class="mb-1">
                                <div class="flex justify-between">
                                    <span>240101001</span>
                                    <span>01/01/24</span>
                                </div>
                            </div>
                            <div class="border-t border-gray-300 pt-1 mb-1">
                                <div class="flex justify-between">
                                    <span>Nasi Gudeg</span>
                                    <span>15.000</span>
                                </div>
                                <div class="text-xs text-gray-500">1x</div>
                            </div>
                            <div class="border-t border-gray-300 pt-1">
                                <div class="flex justify-between font-bold">
                                    <span>TOTAL</span>
                                    <span>16.500</span>
                                </div>
                            </div>
                            <div class="text-center mt-1 text-xs">Thank you</div>
                        </div>
                        <div class="text-center mt-1">
                            <span class="text-xs text-gray-600">Desain simpel</span>
                        </div>
                    </div>

                    <!-- Design 5: Colorful -->
                    <div class="border-2 border-gray-300 rounded-lg p-3 hover:border-pink-500 cursor-pointer" onclick="selectReceiptDesign('colorful')">
                        <h4 class="font-bold text-center mb-2 text-pink-600">üåà Berwarna</h4>
                        <div class="bg-white border rounded receipt-preview text-xs">
                            <div class="text-center font-bold bg-gradient-to-r from-pink-200 to-purple-200 p-1">
                                ‚òÖ RUMAH MAKAN KLATEN ‚òÖ
                            </div>
                            <div class="text-center text-xs bg-blue-100 p-1">üìç Jl. Contoh No. 123</div>
                            <div class="bg-yellow-100 p-1 my-1">
                                <div class="flex justify-between">
                                    <span>üé´ No: 240101001</span>
                                    <span>üìÖ 01/01/24</span>
                                </div>
                            </div>
                            <div class="bg-green-100 p-1 mb-1">
                                <div>üçõ Nasi Gudeg</div>
                                <div class="flex justify-between">
                                    <span>1 porsi</span>
                                    <span>Rp 15.000</span>
                                </div>
                            </div>
                            <div class="bg-red-100 p-1 font-bold">
                                <div class="flex justify-between">
                                    <span>üí∞ TOTAL:</span>
                                    <span>Rp 16.500</span>
                                </div>
                            </div>
                            <div class="text-center mt-1 bg-purple-100 p-1">‚ú® Terima Kasih ‚ú®</div>
                        </div>
                        <div class="text-center mt-1">
                            <span class="text-xs text-gray-600">Penuh warna</span>
                        </div>
                    </div>

                    <!-- Design 6: Retro -->
                    <div class="border-2 border-gray-300 rounded-lg p-3 hover:border-yellow-500 cursor-pointer" onclick="selectReceiptDesign('retro')">
                        <h4 class="font-bold text-center mb-2 text-yellow-600">üìª Retro</h4>
                        <div class="bg-white border rounded receipt-preview text-xs">
                            <div class="text-center">
                                <div class="font-bold">‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì</div>
                                <div class="font-bold">‚ñì RUMAH MAKAN KLATEN ‚ñì</div>
                                <div class="font-bold">‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì</div>
                            </div>
                            <div class="text-center text-xs">‚ñë Jl. Contoh No. 123 ‚ñë</div>
                            <div class="text-center">‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí</div>
                            <div class="text-center">
                                <div>‚ñ∫ TRX: 240101001 ‚óÑ</div>
                                <div>‚ñ∫ 01/01/2024 ‚óÑ</div>
                            </div>
                            <div class="text-center">‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí</div>
                            <div>‚ñ∫ Nasi Gudeg Klaten</div>
                            <div class="flex justify-between">
                                <span>  1 x 15.000</span>
                                <span>15.000 ‚óÑ</span>
                            </div>
                            <div class="text-center">‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì</div>
                            <div class="flex justify-between font-bold">
                                <span>‚ñ∫ TOTAL</span>
                                <span>16.500 ‚óÑ</span>
                            </div>
                            <div class="text-center mt-1">‚ñë‚ñë THANK YOU ‚ñë‚ñë</div>
                        </div>
                        <div class="text-center mt-1">
                            <span class="text-xs text-gray-600">Gaya jadul</span>
                        </div>
                    </div>

                    <!-- Design 7: Professional -->
                    <div class="border-2 border-gray-300 rounded-lg p-3 hover:border-gray-600 cursor-pointer" onclick="selectReceiptDesign('professional')">
                        <h4 class="font-bold text-center mb-2 text-gray-600">üíº Profesional</h4>
                        <div class="bg-white border rounded receipt-preview text-xs">
                            <div class="text-center border-b-2 border-black pb-1 mb-1">
                                <div class="font-bold text-sm">RUMAH MAKAN KLATEN</div>
                                <div class="text-xs">MANOKWARI</div>
                                <div class="text-xs">Jl. Contoh No. 123</div>
                                <div class="text-xs">Telp: (0986) 123456</div>
                            </div>
                            <div class="mb-1">
                                <div class="flex justify-between">
                                    <span>Receipt No.</span>
                                    <span>240101001</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Date/Time</span>
                                    <span>01/01/24 12:00</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Cashier</span>
                                    <span>Admin</span>
                                </div>
                            </div>
                            <div class="border-t border-b border-black py-1 mb-1">
                                <div class="flex justify-between font-bold">
                                    <span>ITEM</span>
                                    <span>AMOUNT</span>
                                </div>
                                <div>Nasi Gudeg Klaten</div>
                                <div class="flex justify-between">
                                    <span>1 x Rp 15,000</span>
                                    <span>Rp 15,000</span>
                                </div>
                            </div>
                            <div class="border-b-2 border-black pb-1">
                                <div class="flex justify-between">
                                    <span>Subtotal:</span>
                                    <span>Rp 15,000</span>
                                </div>
                                <div class="flex justify-between">
                                    <span>Tax (10%):</span>
                                    <span>Rp 1,500</span>
                                </div>
                                <div class="flex justify-between font-bold">
                                    <span>TOTAL:</span>
                                    <span>Rp 16,500</span>
                                </div>
                            </div>
                            <div class="text-center mt-1 text-xs">Thank you for your visit</div>
                        </div>
                        <div class="text-center mt-1">
                            <span class="text-xs text-gray-600">Formal dan rapi</span>
                        </div>
                    </div>

                    <!-- Design 8: Cute -->
                    <div class="border-2 border-gray-300 rounded-lg p-3 hover:border-pink-400 cursor-pointer" onclick="selectReceiptDesign('cute')">
                        <h4 class="font-bold text-center mb-2 text-pink-500">üéÄ Imut</h4>
                        <div class="bg-white border rounded receipt-preview text-xs">
                            <div class="text-center">
                                <div class="font-bold">‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°</div>
                                <div class="font-bold">‚ô° RUMAH MAKAN KLATEN ‚ô°</div>
                                <div class="font-bold">‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°</div>
                            </div>
                            <div class="text-center text-xs">üè† Jl. Contoh No. 123 üè†</div>
                            <div class="text-center text-xs">‚òéÔ∏è (0986) 123456 ‚òéÔ∏è</div>
                            <div class="text-center">‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶</div>
                            <div class="text-center">
                                <div>üé´ No: 240101001</div>
                                <div>üìÖ 01/01/2024 ‚è∞ 12:00</div>
                                <div>üë§ Kasir: Admin</div>
                            </div>
                            <div class="text-center">‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶</div>
                            <div class="text-center bg-pink-50 p-1">
                                <div>üçõ Nasi Gudeg Klaten üçõ</div>
                                <div class="flex justify-between">
                                    <span>1 porsi x Rp 15.000</span>
                                    <span>Rp 15.000</span>
                                </div>
                            </div>
                            <div class="text-center">‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°</div>
                            <div class="flex justify-between font-bold">
                                <span>üíñ TOTAL:</span>
                                <span>Rp 16.500 üíñ</span>
                            </div>
                            <div class="text-center mt-1">‚ú® Terima Kasih Sayang ‚ú®</div>
                            <div class="text-center">üå∏ Sampai Jumpa Lagi üå∏</div>
                        </div>
                        <div class="text-center mt-1">
                            <span class="text-xs text-gray-600">Lucu dan menggemaskan</span>
                        </div>
                    </div>

                    <!-- Design 9: Tech -->
                    <div class="border-2 border-gray-300 rounded-lg p-3 hover:border-cyan-500 cursor-pointer" onclick="selectReceiptDesign('tech')">
                        <h4 class="font-bold text-center mb-2 text-cyan-600">üíª Tech</h4>
                        <div class="bg-white border rounded receipt-preview text-xs bg-black text-green-400 p-1">
                            <div class="text-center font-bold">
                                <div>‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó</div>
                                <div>‚ïë RUMAH MAKAN KLATEN   ‚ïë</div>
                                <div>‚ïë DIGITAL RECEIPT v2.1 ‚ïë</div>
                                <div>‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù</div>
                            </div>
                            <div class="text-center text-xs">
                                <div>IP: 192.168.1.100</div>
                                <div>LOC: Jl. Contoh No. 123</div>
                            </div>
                            <div class="text-center">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
                            <div>
                                <div>‚îÇ TXN_ID: 240101001      ‚îÇ</div>
                                <div>‚îÇ TIMESTAMP: 01/01/24    ‚îÇ</div>
                                <div>‚îÇ USER: admin            ‚îÇ</div>
                            </div>
                            <div class="text-center">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
                            <div>
                                <div>‚îÇ ITEM: Nasi_Gudeg       ‚îÇ</div>
                                <div>‚îÇ QTY: 1 PRICE: 15000    ‚îÇ</div>
                                <div>‚îÇ SUBTOTAL: 15000        ‚îÇ</div>
                            </div>
                            <div class="text-center">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
                            <div class="font-bold">
                                <div>‚îÇ TOTAL_AMOUNT: 16500    ‚îÇ</div>
                            </div>
                            <div class="text-center">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>
                            <div class="text-center mt-1">>>> TRANSACTION_COMPLETE <<<</div>
                        </div>
                        <div class="text-center mt-1">
                            <span class="text-xs text-gray-600">Gaya programmer</span>
                        </div>
                    </div>
                </div>

                <div class="flex justify-center mt-6">
                    <button onclick="closeReceiptDesignModal()" class="bg-gray-500 hover:bg-gray-600 text-white px-6 py-2 rounded-lg font-medium transition-colors">
                        Tutup
                    </button>
                </div>
            </div>
        </div>

        <!-- Receipt Templates (Hidden) -->
        <!-- Classic Design -->
        <div id="receiptTemplate" class="hidden print-only receipt-paper">
            <div class="text-center" style="margin-bottom: 1mm; line-height: 0.9;">
                <div style="font-weight: bold; font-size: 10px; text-align: center;" id="receiptBusinessName">RUMAH MAKAN KLATEN MANOKWARI</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessAddress">Jl. Contoh No. 123</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessPhone">Telp: (0986) 123456</div>
                <div style="border-bottom: 1px dashed #000; margin: 1mm 0;"></div>
            </div>
            
            <div style="font-size: 7px; margin-bottom: 1mm;">
                <div>No. Transaksi: <span id="receiptTransactionId"></span></div>
                <div>Tanggal: <span id="receiptDate"></span></div>
                <div>Waktu: <span id="receiptTime"></span></div>
                <div>Kasir: <span id="receiptCashier">Admin</span></div>
                <div style="border-bottom: 1px dashed #000; margin: 1mm 0;"></div>
            </div>

            <div id="receiptItems" style="font-size: 7px; margin-bottom: 1mm; line-height: 0.8;">
                <!-- Items will be populated -->
            </div>

            <div style="border-bottom: 1px dashed #000; margin: 1mm 0;"></div>
            <div style="font-size: 7px;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Subtotal:</span>
                    <span id="receiptSubtotal"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Pajak Pemda (10%):</span>
                    <span id="receiptTax"></span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold;">
                    <span>TOTAL:</span>
                    <span id="receiptTotal"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Bayar:</span>
                    <span id="receiptPaid"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Kembali:</span>
                    <span id="receiptChange"></span>
                </div>
            </div>

            <div id="receiptFooter" style="font-size: 7px; margin-top: 1mm; text-align: center; line-height: 0.9;">
                <div>Terima Kasih</div>
                <div>Selamat Menikmati!</div>
            </div>
        </div>

        <!-- Modern Design -->
        <div id="receiptTemplateModern" class="hidden print-only receipt-paper">
            <div class="text-center" style="margin-bottom: 1mm; line-height: 0.9; background: #f0f0f0; padding: 1mm;">
                <div style="font-weight: bold; font-size: 10px; text-align: center;" id="receiptBusinessNameModern">üçΩÔ∏è RUMAH MAKAN KLATEN MANOKWARI</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessAddressModern">üìç Jl. Contoh No. 123</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessPhoneModern">üìû Telp: (0986) 123456</div>
                <div style="border-bottom: 2px solid #000; margin: 1mm 0;"></div>
            </div>
            
            <div style="font-size: 7px; margin-bottom: 1mm;">
                <div style="display: flex; justify-content: space-between;">
                    <span>üìã No. Transaksi:</span>
                    <span id="receiptTransactionIdModern"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>üìÖ Tanggal:</span>
                    <span id="receiptDateModern"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>‚è∞ Waktu:</span>
                    <span id="receiptTimeModern"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>üë§ Kasir:</span>
                    <span id="receiptCashierModern">Admin</span>
                </div>
                <div style="border-bottom: 2px solid #000; margin: 1mm 0;"></div>
            </div>

            <div id="receiptItemsModern" style="font-size: 7px; margin-bottom: 1mm; line-height: 0.8;">
                <!-- Items will be populated -->
            </div>

            <div style="border-bottom: 2px solid #000; margin: 1mm 0;"></div>
            <div style="font-size: 7px;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Subtotal:</span>
                    <span id="receiptSubtotalModern"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Pajak Pemda (10%):</span>
                    <span id="receiptTaxModern"></span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold; background: #f0f0f0; padding: 1mm;">
                    <span>üí∞ TOTAL:</span>
                    <span id="receiptTotalModern"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Bayar:</span>
                    <span id="receiptPaidModern"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Kembali:</span>
                    <span id="receiptChangeModern"></span>
                </div>
            </div>

            <div id="receiptFooterModern" style="font-size: 7px; margin-top: 1mm; text-align: center; line-height: 0.9;">
                <div>üôè Terima Kasih</div>
                <div>üòä Selamat Menikmati!</div>
            </div>
        </div>

        <!-- Elegant Design -->
        <div id="receiptTemplateElegant" class="hidden print-only receipt-paper">
            <div class="text-center" style="margin-bottom: 1mm; line-height: 0.9;">
                <div style="font-size: 8px; text-align: center;">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
                <div style="font-weight: bold; font-size: 10px; text-align: center;" id="receiptBusinessNameElegant">RUMAH MAKAN KLATEN MANOKWARI</div>
                <div style="font-size: 8px; text-align: center;">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessAddressElegant">Jl. Contoh No. 123</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessPhoneElegant">Telp: (0986) 123456</div>
                <div style="font-size: 8px; text-align: center;">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
            </div>
            
            <div style="font-size: 7px; margin-bottom: 1mm; text-align: center;">
                <div>Transaksi: <span id="receiptTransactionIdElegant"></span></div>
                <div><span id="receiptDateElegant"></span> - <span id="receiptTimeElegant"></span></div>
                <div>Kasir: <span id="receiptCashierElegant">Admin</span></div>
                <div style="font-size: 8px;">‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ</div>
            </div>

            <div id="receiptItemsElegant" style="font-size: 7px; margin-bottom: 1mm; line-height: 0.8;">
                <!-- Items will be populated -->
            </div>

            <div style="font-size: 8px; text-align: center;">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>
            <div style="font-size: 7px;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Subtotal:</span>
                    <span id="receiptSubtotalElegant"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Pajak Pemda (10%):</span>
                    <span id="receiptTaxElegant"></span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold;">
                    <span>TOTAL BAYAR:</span>
                    <span id="receiptTotalElegant"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Bayar:</span>
                    <span id="receiptPaidElegant"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Kembali:</span>
                    <span id="receiptChangeElegant"></span>
                </div>
            </div>
            <div style="font-size: 8px; text-align: center;">‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê</div>

            <div id="receiptFooterElegant" style="font-size: 7px; margin-top: 1mm; text-align: center; line-height: 0.9;">
                <div>~ Terima Kasih ~</div>
                <div>~ Selamat Menikmati ~</div>
            </div>
        </div>

        <!-- Minimalist Design -->
        <div id="receiptTemplateMinimalist" class="hidden print-only receipt-paper">
            <div class="text-center" style="margin-bottom: 2mm; line-height: 0.9;">
                <div style="font-weight: bold; font-size: 12px; text-align: center;" id="receiptBusinessNameMinimalist">RM KLATEN</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessAddressMinimalist">Jl. Contoh No. 123</div>
            </div>
            
            <div style="font-size: 7px; margin-bottom: 1mm;">
                <div style="display: flex; justify-content: space-between;">
                    <span id="receiptTransactionIdMinimalist"></span>
                    <span id="receiptDateMinimalist"></span>
                </div>
                <div style="font-size: 6px;">Kasir: <span id="receiptCashierMinimalist">Admin</span></div>
            </div>

            <div style="border-top: 1px solid #000; padding-top: 1mm; margin-bottom: 1mm;">
                <div id="receiptItemsMinimalist" style="font-size: 7px; line-height: 0.8;">
                    <!-- Items will be populated -->
                </div>
            </div>

            <div style="border-top: 1px solid #000; padding-top: 1mm; font-size: 7px;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Subtotal:</span>
                    <span id="receiptSubtotalMinimalist"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Tax:</span>
                    <span id="receiptTaxMinimalist"></span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold;">
                    <span>TOTAL:</span>
                    <span id="receiptTotalMinimalist"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Paid:</span>
                    <span id="receiptPaidMinimalist"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Change:</span>
                    <span id="receiptChangeMinimalist"></span>
                </div>
            </div>

            <div id="receiptFooterMinimalist" style="font-size: 7px; margin-top: 2mm; text-align: center;">
                <div>Thank you</div>
            </div>
        </div>

        <!-- Colorful Design -->
        <div id="receiptTemplateColorful" class="hidden print-only receipt-paper">
            <div class="text-center" style="margin-bottom: 1mm; line-height: 0.9; background: #f0f0f0; padding: 1mm;">
                <div style="font-weight: bold; font-size: 10px; text-align: center;" id="receiptBusinessNameColorful">‚òÖ RUMAH MAKAN KLATEN ‚òÖ</div>
                <div style="font-size: 7px; text-align: center; background: #e0e0ff; padding: 0.5mm;" id="receiptBusinessAddressColorful">üìç Jl. Contoh No. 123</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessPhoneColorful">üìû Telp: (0986) 123456</div>
            </div>
            
            <div style="font-size: 7px; margin-bottom: 1mm; background: #ffffcc; padding: 1mm;">
                <div style="display: flex; justify-content: space-between;">
                    <span>üé´ No: <span id="receiptTransactionIdColorful"></span></span>
                    <span>üìÖ <span id="receiptDateColorful"></span></span>
                </div>
                <div>‚è∞ <span id="receiptTimeColorful"></span></div>
                <div>üë§ Kasir: <span id="receiptCashierColorful">Admin</span></div>
            </div>

            <div id="receiptItemsColorful" style="font-size: 7px; margin-bottom: 1mm; line-height: 0.8;">
                <!-- Items will be populated -->
            </div>

            <div style="font-size: 7px; background: #ffcccc; padding: 1mm;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Subtotal:</span>
                    <span id="receiptSubtotalColorful"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Pajak (10%):</span>
                    <span id="receiptTaxColorful"></span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold;">
                    <span>üí∞ TOTAL:</span>
                    <span id="receiptTotalColorful"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Bayar:</span>
                    <span id="receiptPaidColorful"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Kembali:</span>
                    <span id="receiptChangeColorful"></span>
                </div>
            </div>

            <div id="receiptFooterColorful" style="font-size: 7px; margin-top: 1mm; text-align: center; background: #e6ccff; padding: 1mm;">
                <div>‚ú® Terima Kasih ‚ú®</div>
                <div>üåü Selamat Menikmati üåü</div>
            </div>
        </div>

        <!-- Retro Design -->
        <div id="receiptTemplateRetro" class="hidden print-only receipt-paper">
            <div class="text-center" style="margin-bottom: 1mm; line-height: 0.9;">
                <div style="font-size: 8px; text-align: center;">‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì</div>
                <div style="font-weight: bold; font-size: 10px; text-align: center;" id="receiptBusinessNameRetro">‚ñì RUMAH MAKAN KLATEN ‚ñì</div>
                <div style="font-size: 8px; text-align: center;">‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessAddressRetro">‚ñë Jl. Contoh No. 123 ‚ñë</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessPhoneRetro">‚ñë Telp: (0986) 123456 ‚ñë</div>
                <div style="font-size: 8px; text-align: center;">‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí</div>
            </div>
            
            <div style="font-size: 7px; margin-bottom: 1mm; text-align: center;">
                <div>‚ñ∫ TRX: <span id="receiptTransactionIdRetro"></span> ‚óÑ</div>
                <div>‚ñ∫ <span id="receiptDateRetro"></span> - <span id="receiptTimeRetro"></span> ‚óÑ</div>
                <div>‚ñ∫ Kasir: <span id="receiptCashierRetro">Admin</span> ‚óÑ</div>
                <div style="font-size: 8px;">‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí</div>
            </div>

            <div id="receiptItemsRetro" style="font-size: 7px; margin-bottom: 1mm; line-height: 0.8;">
                <!-- Items will be populated -->
            </div>

            <div style="font-size: 8px; text-align: center;">‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì‚ñì</div>
            <div style="font-size: 7px;">
                <div style="display: flex; justify-content: space-between;">
                    <span>‚ñ∫ Subtotal</span>
                    <span id="receiptSubtotalRetro"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>‚ñ∫ Pajak (10%)</span>
                    <span id="receiptTaxRetro"></span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold;">
                    <span>‚ñ∫ TOTAL</span>
                    <span id="receiptTotalRetro">‚óÑ</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>‚ñ∫ Bayar</span>
                    <span id="receiptPaidRetro">‚óÑ</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>‚ñ∫ Kembali</span>
                    <span id="receiptChangeRetro">‚óÑ</span>
                </div>
            </div>

            <div id="receiptFooterRetro" style="font-size: 7px; margin-top: 1mm; text-align: center;">
                <div>‚ñë‚ñë THANK YOU ‚ñë‚ñë</div>
                <div>‚ñë‚ñë COME AGAIN ‚ñë‚ñë</div>
            </div>
        </div>

        <!-- Professional Design -->
        <div id="receiptTemplateProfessional" class="hidden print-only receipt-paper">
            <div class="text-center" style="margin-bottom: 1mm; line-height: 0.9; border-bottom: 2px solid #000; padding-bottom: 1mm;">
                <div style="font-weight: bold; font-size: 10px; text-align: center;" id="receiptBusinessNameProfessional">RUMAH MAKAN KLATEN</div>
                <div style="font-size: 7px; text-align: center;">MANOKWARI</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessAddressProfessional">Jl. Contoh No. 123</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessPhoneProfessional">Telp: (0986) 123456</div>
            </div>
            
            <div style="font-size: 7px; margin-bottom: 1mm;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Receipt No.</span>
                    <span id="receiptTransactionIdProfessional"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Date/Time</span>
                    <span><span id="receiptDateProfessional"></span> <span id="receiptTimeProfessional"></span></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Cashier</span>
                    <span id="receiptCashierProfessional">Admin</span>
                </div>
            </div>

            <div style="border-top: 1px solid #000; border-bottom: 1px solid #000; padding: 1mm 0; margin-bottom: 1mm;">
                <div style="display: flex; justify-content: space-between; font-weight: bold; font-size: 7px;">
                    <span>ITEM</span>
                    <span>AMOUNT</span>
                </div>
                <div id="receiptItemsProfessional" style="font-size: 7px; line-height: 0.8;">
                    <!-- Items will be populated -->
                </div>
            </div>

            <div style="border-bottom: 2px solid #000; padding-bottom: 1mm; font-size: 7px;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Subtotal:</span>
                    <span id="receiptSubtotalProfessional"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Tax (10%):</span>
                    <span id="receiptTaxProfessional"></span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold;">
                    <span>TOTAL:</span>
                    <span id="receiptTotalProfessional"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Paid:</span>
                    <span id="receiptPaidProfessional"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Change:</span>
                    <span id="receiptChangeProfessional"></span>
                </div>
            </div>

            <div id="receiptFooterProfessional" style="font-size: 7px; margin-top: 1mm; text-align: center;">
                <div>Thank you for your visit</div>
                <div>Please come again</div>
            </div>
        </div>

        <!-- Cute Design -->
        <div id="receiptTemplateCute" class="hidden print-only receipt-paper">
            <div class="text-center" style="margin-bottom: 1mm; line-height: 0.9;">
                <div style="font-size: 8px; text-align: center;">‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°</div>
                <div style="font-weight: bold; font-size: 10px; text-align: center;" id="receiptBusinessNameCute">‚ô° RUMAH MAKAN KLATEN ‚ô°</div>
                <div style="font-size: 8px; text-align: center;">‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessAddressCute">üè† Jl. Contoh No. 123 üè†</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessPhoneCute">‚òéÔ∏è Telp: (0986) 123456 ‚òéÔ∏è</div>
                <div style="font-size: 8px; text-align: center;">‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶</div>
            </div>
            
            <div style="font-size: 7px; margin-bottom: 1mm; text-align: center;">
                <div>üé´ No: <span id="receiptTransactionIdCute"></span></div>
                <div>üìÖ <span id="receiptDateCute"></span> ‚è∞ <span id="receiptTimeCute"></span></div>
                <div>üë§ Kasir: <span id="receiptCashierCute">Admin</span></div>
                <div style="font-size: 8px;">‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶</div>
            </div>

            <div id="receiptItemsCute" style="font-size: 7px; margin-bottom: 1mm; line-height: 0.8;">
                <!-- Items will be populated -->
            </div>

            <div style="font-size: 8px; text-align: center;">‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°‚ô°</div>
            <div style="font-size: 7px;">
                <div style="display: flex; justify-content: space-between;">
                    <span>Subtotal:</span>
                    <span id="receiptSubtotalCute"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Pajak (10%):</span>
                    <span id="receiptTaxCute"></span>
                </div>
                <div style="display: flex; justify-content: space-between; font-weight: bold;">
                    <span>üíñ TOTAL:</span>
                    <span id="receiptTotalCute">üíñ</span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Bayar:</span>
                    <span id="receiptPaidCute"></span>
                </div>
                <div style="display: flex; justify-content: space-between;">
                    <span>Kembali:</span>
                    <span id="receiptChangeCute"></span>
                </div>
            </div>

            <div id="receiptFooterCute" style="font-size: 7px; margin-top: 1mm; text-align: center;">
                <div>‚ú® Terima Kasih Sayang ‚ú®</div>
                <div>üå∏ Sampai Jumpa Lagi üå∏</div>
            </div>
        </div>

        <!-- Tech Design -->
        <div id="receiptTemplateTech" class="hidden print-only receipt-paper" style="background: #000; color: #00ff00;">
            <div class="text-center" style="margin-bottom: 1mm; line-height: 0.9;">
                <div style="font-size: 8px; text-align: center;">‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó</div>
                <div style="font-weight: bold; font-size: 10px; text-align: center;" id="receiptBusinessNameTech">‚ïë RUMAH MAKAN KLATEN      ‚ïë</div>
                <div style="font-size: 8px; text-align: center;">‚ïë DIGITAL RECEIPT v2.1    ‚ïë</div>
                <div style="font-size: 8px; text-align: center;">‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù</div>
                <div style="font-size: 7px; text-align: center;">IP: 192.168.1.100</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessAddressTech">LOC: Jl. Contoh No. 123</div>
                <div style="font-size: 7px; text-align: center;" id="receiptBusinessPhoneTech">TEL: (0986) 123456</div>
            </div>
            
            <div style="font-size: 7px; margin-bottom: 1mm;">
                <div style="font-size: 8px; text-align: center;">‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</div>
                <div>‚îÇ TXN_ID: <span id="receiptTransactionIdTech"></span></div>
                <div>‚îÇ TIMESTAMP: <span id="receiptDateTech"></span> <span id="receiptTimeTech"></span></div>
                <div>‚îÇ USER: <span id="receiptCashierTech">admin</span></div>
                <div style="font-size: 8px; text-align: center;">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
            </div>

            <div id="receiptItemsTech" style="font-size: 7px; margin-bottom: 1mm; line-height: 0.8;">
                <!-- Items will be populated -->
            </div>

            <div style="font-size: 8px; text-align: center;">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>
            <div style="font-size: 7px;">
                <div>‚îÇ SUBTOTAL: <span id="receiptSubtotalTech"></span></div>
                <div>‚îÇ TAX_10PCT: <span id="receiptTaxTech"></span></div>
                <div style="font-weight: bold;">‚îÇ TOTAL_AMOUNT: <span id="receiptTotalTech"></span></div>
                <div>‚îÇ CASH_RECEIVED: <span id="receiptPaidTech"></span></div>
                <div>‚îÇ CHANGE_DUE: <span id="receiptChangeTech"></span></div>
            </div>
            <div style="font-size: 8px; text-align: center;">‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</div>

            <div id="receiptFooterTech" style="font-size: 7px; margin-top: 1mm; text-align: center;">
                <div>>>> TRANSACTION_COMPLETE <<<</div>
                <div>>>> THANK_YOU <<<</div>
            </div>
        </div>
    </div>

    <script>
        // Data menu
        let menuData = {
            makanan: [
                { id: 1, name: 'Nasi Gudeg Klaten', price: 15000, category: 'makanan' },
                { id: 2, name: 'Ayam Goreng Kremes', price: 18000, category: 'makanan' },
                { id: 3, name: 'Soto Ayam Klaten', price: 12000, category: 'makanan' },
                { id: 4, name: 'Nasi Pecel', price: 10000, category: 'makanan' },
                { id: 5, name: 'Bakso Malang', price: 13000, category: 'makanan' },
                { id: 6, name: 'Mie Ayam Pangsit', price: 14000, category: 'makanan' }
            ],
            minuman: [
                { id: 7, name: 'Es Teh Manis', price: 5000, category: 'minuman' },
                { id: 8, name: 'Es Jeruk', price: 6000, category: 'minuman' },
                { id: 9, name: 'Kopi Hitam', price: 4000, category: 'minuman' },
                { id: 10, name: 'Jus Alpukat', price: 8000, category: 'minuman' },
                { id: 11, name: 'Es Campur', price: 10000, category: 'minuman' },
                { id: 12, name: 'Air Mineral', price: 3000, category: 'minuman' }
            ]
        };

        let currentOrder = [];
        let isEditMode = false;
        let currentCategory = 'makanan';
        let bluetoothDevice = null;
        let bluetoothCharacteristic = null;
        
        // Business settings
        let businessSettings = {
            name: 'RUMAH MAKAN KLATEN MANOKWARI',
            address: 'Jl. Contoh No. 123',
            phone: '(0986) 123456',
            cashier: 'Admin'
        };
        
        // Footer settings
        let footerSettings = {
            line1: 'Terima Kasih',
            line2: 'Selamat Menikmati!',
            line3: ''
        };
        
        // Receipt design settings
        let currentReceiptDesign = 'classic';

        // Initialize app
        document.addEventListener('DOMContentLoaded', function() {
            updateTime();
            setInterval(updateTime, 1000);
            showCategory('makanan');
            loadSettings();
            loadFooterSettings();
            loadReceiptDesign();
            
            // Close navigation menu when clicking outside
            document.addEventListener('click', function(event) {
                const navMenu = document.getElementById('navigationMenu');
                const navBtn = document.getElementById('navMenuBtn');
                if (!navBtn.contains(event.target) && !navMenu.contains(event.target)) {
                    closeNavigationMenu();
                }
            });
        });
        
        function toggleNavigationMenu() {
            const menu = document.getElementById('navigationMenu');
            menu.classList.toggle('hidden');
        }
        
        function closeNavigationMenu() {
            document.getElementById('navigationMenu').classList.add('hidden');
        }
        
        function loadSettings() {
            const saved = localStorage.getItem('businessSettings');
            if (saved) {
                businessSettings = JSON.parse(saved);
                updateDisplayedSettings();
            }
        }
        
        function loadFooterSettings() {
            const saved = localStorage.getItem('footerSettings');
            if (saved) {
                footerSettings = JSON.parse(saved);
            }
        }
        
        function updateDisplayedSettings() {
            // Update header with business info
            document.getElementById('headerBusinessName').textContent = `üçΩÔ∏è ${businessSettings.name}`;
            document.getElementById('headerBusinessAddress').textContent = businessSettings.address;
            document.getElementById('headerCashierName').textContent = businessSettings.cashier;
        }
        
        function updateAllReceiptPreviews() {
            // Update preview elements if they exist
            const previewBusinessName = document.getElementById('previewBusinessName');
            const previewBusinessAddress = document.getElementById('previewBusinessAddress');
            const previewBusinessPhone = document.getElementById('previewBusinessPhone');
            const previewCashier = document.getElementById('previewCashier');
            
            if (previewBusinessName) previewBusinessName.textContent = businessSettings.name;
            if (previewBusinessAddress) previewBusinessAddress.textContent = businessSettings.address;
            if (previewBusinessPhone) previewBusinessPhone.textContent = `Telp: ${businessSettings.phone}`;
            if (previewCashier) previewCashier.textContent = businessSettings.cashier;
        }
        
        function openSettingsModal() {
            document.getElementById('businessName').value = businessSettings.name;
            document.getElementById('businessAddress').value = businessSettings.address;
            document.getElementById('businessPhone').value = businessSettings.phone;
            document.getElementById('cashierName').value = businessSettings.cashier;
            
            document.getElementById('settingsModal').classList.remove('hidden');
            document.getElementById('settingsModal').classList.add('flex');
        }
        
        function closeSettingsModal() {
            document.getElementById('settingsModal').classList.add('hidden');
            document.getElementById('settingsModal').classList.remove('flex');
        }
        
        function saveSettings() {
            const newName = document.getElementById('businessName').value.trim();
            const newAddress = document.getElementById('businessAddress').value.trim();
            const newPhone = document.getElementById('businessPhone').value.trim();
            const newCashier = document.getElementById('cashierName').value.trim();
            
            // Update settings with new values or keep existing if empty
            if (newName) businessSettings.name = newName;
            if (newAddress) businessSettings.address = newAddress;
            if (newPhone) businessSettings.phone = newPhone;
            if (newCashier) businessSettings.cashier = newCashier;
            
            // Save to localStorage
            localStorage.setItem('businessSettings', JSON.stringify(businessSettings));
            
            // Update all displayed settings immediately
            updateDisplayedSettings();
            updateAllReceiptPreviews();
            
            closeSettingsModal();
            showNotification('Pengaturan berhasil disimpan!', 'success');
        }
        
        function openFooterModal() {
            // Load current footer settings into form
            document.getElementById('footerLine1').value = footerSettings.line1;
            document.getElementById('footerLine2').value = footerSettings.line2;
            document.getElementById('footerLine3').value = footerSettings.line3;
            
            // Update preview
            updateFooterPreview();
            
            document.getElementById('footerModal').classList.remove('hidden');
            document.getElementById('footerModal').classList.add('flex');
        }
        
        function closeFooterModal() {
            document.getElementById('footerModal').classList.add('hidden');
            document.getElementById('footerModal').classList.remove('flex');
        }
        
        function updateFooterPreview() {
            const line1 = document.getElementById('footerLine1').value || 'Terima Kasih';
            const line2 = document.getElementById('footerLine2').value || 'Selamat Menikmati!';
            const line3 = document.getElementById('footerLine3').value;
            
            document.getElementById('footerPreviewLine1').textContent = line1;
            document.getElementById('footerPreviewLine2').textContent = line2;
            
            const line3Element = document.getElementById('footerPreviewLine3');
            if (line3.trim()) {
                line3Element.textContent = line3;
                line3Element.classList.remove('hidden');
            } else {
                line3Element.classList.add('hidden');
            }
        }
        
        function resetFooterToDefault() {
            document.getElementById('footerLine1').value = 'Terima Kasih';
            document.getElementById('footerLine2').value = 'Selamat Menikmati!';
            document.getElementById('footerLine3').value = '';
            updateFooterPreview();
        }
        
        function saveFooterSettings() {
            const line1 = document.getElementById('footerLine1').value.trim() || 'Terima Kasih';
            const line2 = document.getElementById('footerLine2').value.trim() || 'Selamat Menikmati!';
            const line3 = document.getElementById('footerLine3').value.trim();
            
            footerSettings = {
                line1: line1,
                line2: line2,
                line3: line3
            };
            
            // Save to localStorage
            localStorage.setItem('footerSettings', JSON.stringify(footerSettings));
            
            closeFooterModal();
            showNotification('Footer struk berhasil disimpan!', 'success');
        }
        
        // Add event listeners for real-time preview
        document.addEventListener('DOMContentLoaded', function() {
            const footerInputs = ['footerLine1', 'footerLine2', 'footerLine3'];
            footerInputs.forEach(inputId => {
                const input = document.getElementById(inputId);
                if (input) {
                    input.addEventListener('input', updateFooterPreview);
                }
            });
        });
        
        function generateTransactionId() {
            const now = new Date();
            const dateStr = now.toISOString().slice(2, 10).replace(/-/g, ''); // YYMMDD (6 digits)
            const timeStr = now.toTimeString().slice(0, 5).replace(/:/g, ''); // HHMM (4 digits)
            const random = Math.floor(Math.random() * 10); // 1 digit
            return `${dateStr}${timeStr}${random}`;
        }

        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleString('id-ID', {
                weekday: 'long',
                year: 'numeric',
                month: 'long',
                day: 'numeric',
                hour: '2-digit',
                minute: '2-digit'
            });
            document.getElementById('currentTime').textContent = timeString;
        }

        function showCategory(category) {
            currentCategory = category;
            
            // Update active tab
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.classList.remove('border-orange-500', 'text-orange-600');
                btn.classList.add('text-gray-500');
            });
            
            const activeBtn = document.querySelector(`[data-category="${category}"]`);
            activeBtn.classList.add('border-orange-500', 'text-orange-600');
            activeBtn.classList.remove('text-gray-500');

            renderMenu();
        }

        function renderMenu() {
            const container = document.getElementById('menuContainer');
            const items = menuData[currentCategory];
            
            container.innerHTML = items.map(item => `
                <div class="border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow">
                    <div class="flex justify-between items-start mb-2">
                        <h3 class="font-semibold text-gray-800">${item.name}</h3>
                        ${isEditMode ? `
                            <div class="flex space-x-1">
                                <button onclick="editItem(${item.id})" class="text-blue-600 hover:text-blue-800 text-sm px-2 py-1 rounded hover:bg-blue-50" title="Edit Menu">
                                    ‚úèÔ∏è
                                </button>
                                <button onclick="deleteItem(${item.id})" class="text-red-600 hover:text-red-800 text-sm px-2 py-1 rounded hover:bg-red-50" title="Hapus Menu">
                                    üóëÔ∏è
                                </button>
                            </div>
                        ` : ''}
                    </div>
                    <div class="flex justify-between items-center">
                        <span class="text-lg font-bold text-orange-600" ${isEditMode ? `onclick="editPrice(${item.id})"` : ''} ${isEditMode ? 'class="cursor-pointer hover:bg-yellow-100 px-2 py-1 rounded"' : ''}>
                            Rp ${item.price.toLocaleString('id-ID')}
                        </span>
                        ${!isEditMode ? `
                            <button onclick="addToOrder(${item.id})" class="bg-orange-600 hover:bg-orange-700 text-white px-3 py-1 rounded-lg text-sm font-medium transition-colors">
                                + Tambah
                            </button>
                        ` : ''}
                    </div>
                </div>
            `).join('');
        }

        function toggleEditMode() {
            isEditMode = !isEditMode;
            const btn = document.getElementById('editModeBtn');
            const editActions = document.getElementById('editModeActions');
            
            if (isEditMode) {
                btn.textContent = '‚úÖ Selesai Edit';
                btn.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                btn.classList.add('bg-green-600', 'hover:bg-green-700');
                editActions.classList.remove('hidden');
            } else {
                btn.textContent = '‚úèÔ∏è Edit Menu';
                btn.classList.remove('bg-green-600', 'hover:bg-green-700');
                btn.classList.add('bg-blue-600', 'hover:bg-blue-700');
                editActions.classList.add('hidden');
            }
            
            renderMenu();
        }

        let editingMenuId = null;
        
        function openAddMenuModal() {
            editingMenuId = null;
            document.getElementById('menuModalTitle').textContent = '‚ûï Tambah Menu Baru';
            document.getElementById('menuName').value = '';
            document.getElementById('menuPrice').value = '';
            document.getElementById('menuCategory').value = currentCategory;
            
            document.getElementById('addMenuModal').classList.remove('hidden');
            document.getElementById('addMenuModal').classList.add('flex');
            document.getElementById('menuName').focus();
        }
        
        function closeAddMenuModal() {
            document.getElementById('addMenuModal').classList.add('hidden');
            document.getElementById('addMenuModal').classList.remove('flex');
            editingMenuId = null;
        }
        
        function editItem(id) {
            const item = findItemById(id);
            if (!item) return;
            
            editingMenuId = id;
            document.getElementById('menuModalTitle').textContent = '‚úèÔ∏è Edit Menu';
            document.getElementById('menuName').value = item.name;
            document.getElementById('menuPrice').value = item.price;
            document.getElementById('menuCategory').value = item.category;
            
            document.getElementById('addMenuModal').classList.remove('hidden');
            document.getElementById('addMenuModal').classList.add('flex');
            document.getElementById('menuName').focus();
        }
        
        function deleteItem(id) {
            const item = findItemById(id);
            if (!item) return;
            
            // Create custom confirmation modal instead of browser confirm
            const confirmModal = document.createElement('div');
            confirmModal.className = 'fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50';
            confirmModal.innerHTML = `
                <div class="bg-white rounded-xl p-6 max-w-sm w-full mx-4">
                    <h3 class="text-lg font-bold mb-3 text-red-600">üóëÔ∏è Hapus Menu</h3>
                    <p class="text-gray-700 mb-4">Yakin ingin menghapus menu "<strong>${item.name}</strong>"?</p>
                    <div class="flex space-x-3">
                        <button onclick="this.closest('.fixed').remove()" class="flex-1 bg-gray-500 hover:bg-gray-600 text-white py-2 rounded-lg font-medium transition-colors">
                            Batal
                        </button>
                        <button onclick="confirmDeleteItem(${id}); this.closest('.fixed').remove()" class="flex-1 bg-red-600 hover:bg-red-700 text-white py-2 rounded-lg font-medium transition-colors">
                            Hapus
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(confirmModal);
        }
        
        function confirmDeleteItem(id) {
            // Remove from current order if exists
            currentOrder = currentOrder.filter(orderItem => orderItem.id !== id);
            
            // Remove from menu data
            for (let category in menuData) {
                menuData[category] = menuData[category].filter(item => item.id !== id);
            }
            
            renderMenu();
            renderOrder();
            showNotification('Menu berhasil dihapus!', 'success');
        }
        
        function saveMenu() {
            const name = document.getElementById('menuName').value.trim();
            const price = parseInt(document.getElementById('menuPrice').value);
            const category = document.getElementById('menuCategory').value;
            
            if (!name) {
                showNotification('Nama menu tidak boleh kosong!', 'error');
                return;
            }
            
            if (!price || price <= 0) {
                showNotification('Harga harus lebih dari 0!', 'error');
                return;
            }
            
            if (editingMenuId) {
                // Edit existing menu
                const item = findItemById(editingMenuId);
                if (item) {
                    // If category changed, move item to new category
                    if (item.category !== category) {
                        // Remove from old category
                        menuData[item.category] = menuData[item.category].filter(i => i.id !== editingMenuId);
                        
                        // Add to new category
                        item.category = category;
                        menuData[category].push(item);
                    }
                    
                    item.name = name;
                    item.price = price;
                    item.category = category;
                    
                    showNotification('Menu berhasil diperbarui!', 'success');
                }
            } else {
                // Add new menu
                const newId = Math.max(...Object.values(menuData).flat().map(item => item.id)) + 1;
                const newItem = {
                    id: newId,
                    name: name,
                    price: price,
                    category: category
                };
                
                menuData[category].push(newItem);
                showNotification('Menu baru berhasil ditambahkan!', 'success');
            }
            
            renderMenu();
            closeAddMenuModal();
        }

        function editPrice(id) {
            // This function is kept for backward compatibility but now opens the edit modal
            editItem(id);
        }

        function findItemById(id) {
            for (let category in menuData) {
                const item = menuData[category].find(item => item.id === id);
                if (item) return item;
            }
            return null;
        }

        function addToOrder(id) {
            const item = findItemById(id);
            const existingItem = currentOrder.find(orderItem => orderItem.id === id);
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                currentOrder.push({
                    ...item,
                    quantity: 1
                });
            }
            
            renderOrder();
        }

        function removeFromOrder(id) {
            currentOrder = currentOrder.filter(item => item.id !== id);
            renderOrder();
        }

        function updateQuantity(id, change) {
            const item = currentOrder.find(orderItem => orderItem.id === id);
            if (item) {
                item.quantity += change;
                if (item.quantity <= 0) {
                    removeFromOrder(id);
                } else {
                    renderOrder();
                }
            }
        }

        function renderOrder() {
            const container = document.getElementById('orderItems');
            const paymentBtn = document.getElementById('paymentBtn');
            
            if (currentOrder.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8">
                        Belum ada pesanan
                    </div>
                `;
                paymentBtn.disabled = true;
            } else {
                container.innerHTML = currentOrder.map(item => `
                    <div class="flex justify-between items-center p-3 bg-gray-50 rounded-lg">
                        <div class="flex-1">
                            <div class="font-medium text-sm">${item.name}</div>
                            <div class="text-orange-600 font-semibold">Rp ${item.price.toLocaleString('id-ID')}</div>
                        </div>
                        <div class="flex items-center space-x-2">
                            <button onclick="updateQuantity(${item.id}, -1)" class="w-6 h-6 bg-red-500 hover:bg-red-600 text-white rounded-full text-xs font-bold">-</button>
                            <span class="w-8 text-center font-semibold">${item.quantity}</span>
                            <button onclick="updateQuantity(${item.id}, 1)" class="w-6 h-6 bg-green-500 hover:bg-green-600 text-white rounded-full text-xs font-bold">+</button>
                        </div>
                    </div>
                `).join('');
                paymentBtn.disabled = false;
            }
            
            updateTotal();
        }

        function updateTotal() {
            const subtotal = currentOrder.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = Math.round(subtotal * 0.1);
            const total = subtotal + tax;
            
            document.getElementById('subtotalAmount').textContent = `Rp ${subtotal.toLocaleString('id-ID')}`;
            document.getElementById('taxAmount').textContent = `Rp ${tax.toLocaleString('id-ID')}`;
            document.getElementById('totalAmount').textContent = `Rp ${total.toLocaleString('id-ID')}`;
        }

        function clearOrder() {
            if (currentOrder.length > 0 && confirm('Hapus semua pesanan?')) {
                currentOrder = [];
                renderOrder();
            }
        }

        function processPayment() {
            const subtotal = currentOrder.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = Math.round(subtotal * 0.1);
            const total = subtotal + tax;
            
            document.getElementById('totalPayment').value = `Rp ${total.toLocaleString('id-ID')}`;
            document.getElementById('cashReceived').value = '';
            document.getElementById('changeAmount').value = '';
            
            // Set current date and time
            setCurrentDateTime();
            
            // Update preview
            updateReceiptPreview();
            
            document.getElementById('paymentModal').classList.remove('hidden');
            document.getElementById('paymentModal').classList.add('flex');
            document.getElementById('cashReceived').focus();
        }
        
        function setCurrentDateTime() {
            const now = new Date();
            const dateStr = now.toISOString().split('T')[0]; // YYYY-MM-DD format
            const timeStr = now.toTimeString().slice(0, 5); // HH:MM format
            
            document.getElementById('transactionDate').value = dateStr;
            document.getElementById('transactionTime').value = timeStr;
        }
        
        function resetDateTime() {
            setCurrentDateTime();
            updateReceiptPreview();
        }

        function closePaymentModal() {
            document.getElementById('paymentModal').classList.add('hidden');
            document.getElementById('paymentModal').classList.remove('flex');
        }

        function updateReceiptPreview() {
            const subtotal = currentOrder.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = Math.round(subtotal * 0.1);
            const total = subtotal + tax;
            const cashReceived = parseInt(document.getElementById('cashReceived').value) || 0;
            const change = cashReceived - total;
            
            // Generate transaction ID
            const transactionId = generateTransactionId();
            
            // Update business info in preview
            document.getElementById('previewBusinessName').textContent = businessSettings.name;
            document.getElementById('previewBusinessAddress').textContent = businessSettings.address;
            document.getElementById('previewBusinessPhone').textContent = `Telp: ${businessSettings.phone}`;
            
            // Get custom date and time from inputs
            const customDate = document.getElementById('transactionDate').value;
            const customTime = document.getElementById('transactionTime').value;
            
            // Format date and time for display
            let displayDate, displayTime;
            if (customDate) {
                const dateObj = new Date(customDate);
                displayDate = dateObj.toLocaleDateString('id-ID');
            } else {
                displayDate = new Date().toLocaleDateString('id-ID');
            }
            
            if (customTime) {
                displayTime = customTime;
            } else {
                displayTime = new Date().toLocaleTimeString('id-ID');
            }
            
            document.getElementById('previewTransactionId').textContent = transactionId;
            document.getElementById('previewDate').textContent = displayDate;
            document.getElementById('previewTime').textContent = displayTime;
            document.getElementById('previewCashier').textContent = businessSettings.cashier;
            
            // Update items with tighter spacing and separators
            const itemsHtml = currentOrder.map((item, index) => `
                <div style="display: flex; justify-content: space-between; margin-bottom: 1px;">
                    <span>${item.name}</span>
                </div>
                <div style="display: flex; justify-content: space-between; margin-bottom: 2px;">
                    <span>${item.quantity} x Rp ${item.price.toLocaleString('id-ID')}</span>
                    <span>Rp ${(item.quantity * item.price).toLocaleString('id-ID')}</span>
                </div>
                ${index < currentOrder.length - 1 ? '<div style="border-bottom: 1px dashed #ccc; margin: 2px 0;"></div>' : ''}
            `).join('');
            
            document.getElementById('previewItems').innerHTML = itemsHtml;
            document.getElementById('previewSubtotal').textContent = `Rp ${subtotal.toLocaleString('id-ID')}`;
            document.getElementById('previewTax').textContent = `Rp ${tax.toLocaleString('id-ID')}`;
            document.getElementById('previewTotal').textContent = `Rp ${total.toLocaleString('id-ID')}`;
            document.getElementById('previewPaid').textContent = `Rp ${cashReceived.toLocaleString('id-ID')}`;
            document.getElementById('previewChange').textContent = change >= 0 ? `Rp ${change.toLocaleString('id-ID')}` : 'Rp 0';
        }

        // Calculate change when cash received changes
        document.getElementById('cashReceived').addEventListener('input', function() {
            const subtotal = currentOrder.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = Math.round(subtotal * 0.1);
            const total = subtotal + tax;
            const cashReceived = parseInt(this.value) || 0;
            const change = cashReceived - total;
            const printBtn = document.getElementById('printBtn');
            
            if (change >= 0) {
                document.getElementById('changeAmount').value = `Rp ${change.toLocaleString('id-ID')}`;
                printBtn.disabled = false;
            } else {
                document.getElementById('changeAmount').value = 'Uang kurang';
                printBtn.disabled = true;
            }
            
            // Update preview in real-time
            updateReceiptPreview();
        });
        
        // Update preview when date or time changes
        document.getElementById('transactionDate').addEventListener('change', updateReceiptPreview);
        document.getElementById('transactionTime').addEventListener('change', updateReceiptPreview);

        async function connectPrinter() {
            try {
                // Check if Web Bluetooth is supported
                if (!navigator.bluetooth) {
                    showNotification('Browser tidak mendukung Bluetooth. Gunakan Chrome/Edge terbaru dengan HTTPS.', 'error');
                    return;
                }

                const connectBtn = document.getElementById('connectBtn');
                const statusSpan = document.getElementById('printerStatus');
                
                connectBtn.textContent = 'Menghubungkan...';
                connectBtn.disabled = true;
                
                // Request Bluetooth device with broader compatibility
                bluetoothDevice = await navigator.bluetooth.requestDevice({
                    acceptAllDevices: true,
                    optionalServices: [
                        '000018f0-0000-1000-8000-00805f9b34fb', // Generic printer service
                        '0000ff00-0000-1000-8000-00805f9b34fb', // Common thermal printer service
                        '49535343-fe7d-4ae5-8fa9-9fafd205e455', // Another common service
                        'e7810a71-73ae-499d-8c15-faa9aef0c3f2'  // Alternative service
                    ]
                });
                
                // Connect to GATT server
                const server = await bluetoothDevice.gatt.connect();
                
                // Try to find a suitable service and characteristic
                const services = await server.getPrimaryServices();
                let foundCharacteristic = false;
                
                for (const service of services) {
                    try {
                        const characteristics = await service.getCharacteristics();
                        for (const characteristic of characteristics) {
                            // Look for writable characteristics
                            if (characteristic.properties.write || characteristic.properties.writeWithoutResponse) {
                                bluetoothCharacteristic = characteristic;
                                foundCharacteristic = true;
                                break;
                            }
                        }
                        if (foundCharacteristic) break;
                    } catch (e) {
                        // Continue to next service if this one fails
                        continue;
                    }
                }
                
                if (!foundCharacteristic) {
                    throw new Error('Tidak dapat menemukan karakteristik printer yang sesuai');
                }
                
                statusSpan.textContent = `Terhubung: ${bluetoothDevice.name || 'Printer'}`;
                statusSpan.className = 'text-sm text-green-600 font-medium';
                connectBtn.textContent = 'Putuskan';
                connectBtn.onclick = disconnectPrinter;
                connectBtn.disabled = false;
                
                showNotification('Printer berhasil terhubung!', 'success');
                
                // Handle disconnection
                bluetoothDevice.addEventListener('gattserverdisconnected', () => {
                    statusSpan.textContent = 'Tidak terhubung';
                    statusSpan.className = 'text-sm text-gray-600';
                    connectBtn.textContent = 'Hubungkan';
                    connectBtn.onclick = connectPrinter;
                    bluetoothDevice = null;
                    bluetoothCharacteristic = null;
                    showNotification('Printer terputus', 'info');
                });
                
            } catch (error) {
                console.error('Bluetooth connection failed:', error);
                document.getElementById('printerStatus').textContent = 'Gagal terhubung';
                document.getElementById('printerStatus').className = 'text-sm text-red-600';
                document.getElementById('connectBtn').textContent = 'Hubungkan';
                document.getElementById('connectBtn').disabled = false;
                
                // Show specific error messages
                if (error.name === 'NotFoundError') {
                    showNotification('Tidak ada perangkat Bluetooth yang dipilih.', 'error');
                } else if (error.name === 'SecurityError') {
                    showNotification('Akses Bluetooth ditolak. Pastikan menggunakan HTTPS.', 'error');
                } else if (error.name === 'NotSupportedError') {
                    showNotification('Browser tidak mendukung Web Bluetooth API.', 'error');
                } else {
                    showNotification(`Gagal terhubung: ${error.message}`, 'error');
                }
            }
        }
        
        function disconnectPrinter() {
            if (bluetoothDevice && bluetoothDevice.gatt.connected) {
                bluetoothDevice.gatt.disconnect();
            }
        }
        
        function openReceiptDesignModal() {
            document.getElementById('receiptDesignModal').classList.remove('hidden');
            document.getElementById('receiptDesignModal').classList.add('flex');
        }
        
        function closeReceiptDesignModal() {
            document.getElementById('receiptDesignModal').classList.add('hidden');
            document.getElementById('receiptDesignModal').classList.remove('flex');
        }
        
        function selectReceiptDesign(design) {
            currentReceiptDesign = design;
            
            // Update display
            const designNames = {
                'classic': 'Klasik',
                'modern': 'Modern',
                'elegant': 'Elegan',
                'minimalist': 'Minimalis',
                'colorful': 'Berwarna',
                'retro': 'Retro',
                'professional': 'Profesional',
                'cute': 'Imut',
                'tech': 'Tech'
            };
            
            document.getElementById('currentDesign').textContent = designNames[design];
            
            // Save to localStorage
            localStorage.setItem('receiptDesign', design);
            
            closeReceiptDesignModal();
            showNotification(`Desain struk berhasil diubah ke ${designNames[design]}!`, 'success');
        }
        
        function loadReceiptDesign() {
            const saved = localStorage.getItem('receiptDesign');
            if (saved) {
                currentReceiptDesign = saved;
                const designNames = {
                    'classic': 'Klasik',
                    'modern': 'Modern',
                    'elegant': 'Elegan',
                    'minimalist': 'Minimalis',
                    'colorful': 'Berwarna',
                    'retro': 'Retro',
                    'professional': 'Profesional',
                    'cute': 'Imut',
                    'tech': 'Tech'
                };
                document.getElementById('currentDesign').textContent = designNames[saved];
            }
        }
        
        function getReceiptTemplateId() {
            switch(currentReceiptDesign) {
                case 'modern': return 'receiptTemplateModern';
                case 'elegant': return 'receiptTemplateElegant';
                case 'minimalist': return 'receiptTemplateMinimalist';
                case 'colorful': return 'receiptTemplateColorful';
                case 'retro': return 'receiptTemplateRetro';
                case 'professional': return 'receiptTemplateProfessional';
                case 'cute': return 'receiptTemplateCute';
                case 'tech': return 'receiptTemplateTech';
                default: return 'receiptTemplate';
            }
        }
        
        function updateReceiptTemplate(transactionId, displayDate, displayTime, subtotal, tax, total, cashReceived, change) {
            const suffix = currentReceiptDesign === 'classic' ? '' : currentReceiptDesign.charAt(0).toUpperCase() + currentReceiptDesign.slice(1);
            
            // Update business info based on design
            let businessName = businessSettings.name;
            let businessAddress = businessSettings.address;
            let businessPhone = `Telp: ${businessSettings.phone}`;
            
            if (currentReceiptDesign === 'modern') {
                businessName = `üçΩÔ∏è ${businessSettings.name}`;
                businessAddress = `üìç ${businessSettings.address}`;
                businessPhone = `üìû Telp: ${businessSettings.phone}`;
            } else if (currentReceiptDesign === 'colorful') {
                businessName = `‚òÖ ${businessSettings.name} ‚òÖ`;
                businessAddress = `üìç ${businessSettings.address}`;
                businessPhone = `üìû Telp: ${businessSettings.phone}`;
            } else if (currentReceiptDesign === 'retro') {
                businessName = `‚ñì ${businessSettings.name} ‚ñì`;
                businessAddress = `‚ñë ${businessSettings.address} ‚ñë`;
                businessPhone = `‚ñë Telp: ${businessSettings.phone} ‚ñë`;
            } else if (currentReceiptDesign === 'cute') {
                businessName = `‚ô° ${businessSettings.name} ‚ô°`;
                businessAddress = `üè† ${businessSettings.address} üè†`;
                businessPhone = `‚òéÔ∏è Telp: ${businessSettings.phone} ‚òéÔ∏è`;
            } else if (currentReceiptDesign === 'tech') {
                businessName = `‚ïë ${businessSettings.name}      ‚ïë`;
                businessAddress = `LOC: ${businessSettings.address}`;
                businessPhone = `TEL: ${businessSettings.phone}`;
            } else if (currentReceiptDesign === 'minimalist') {
                businessName = 'RM KLATEN';
            }
            
            document.getElementById(`receiptBusinessName${suffix}`).textContent = businessName;
            document.getElementById(`receiptBusinessAddress${suffix}`).textContent = businessAddress;
            if (document.getElementById(`receiptBusinessPhone${suffix}`)) {
                document.getElementById(`receiptBusinessPhone${suffix}`).textContent = businessPhone;
            }
            
            // Update transaction info
            document.getElementById(`receiptTransactionId${suffix}`).textContent = transactionId;
            document.getElementById(`receiptDate${suffix}`).textContent = displayDate;
            if (document.getElementById(`receiptTime${suffix}`)) {
                document.getElementById(`receiptTime${suffix}`).textContent = displayTime;
            }
            document.getElementById(`receiptCashier${suffix}`).textContent = businessSettings.cashier;
            
            // Update totals
            document.getElementById(`receiptSubtotal${suffix}`).textContent = `Rp ${subtotal.toLocaleString('id-ID')}`;
            document.getElementById(`receiptTax${suffix}`).textContent = `Rp ${tax.toLocaleString('id-ID')}`;
            document.getElementById(`receiptTotal${suffix}`).textContent = `Rp ${total.toLocaleString('id-ID')}`;
            document.getElementById(`receiptPaid${suffix}`).textContent = `Rp ${cashReceived.toLocaleString('id-ID')}`;
            document.getElementById(`receiptChange${suffix}`).textContent = `Rp ${change.toLocaleString('id-ID')}`;
            
            // Update footer based on design and settings
            updateReceiptFooter(suffix);
            
            // Populate items based on design
            let itemsHtml = '';
            
            if (currentReceiptDesign === 'modern') {
                itemsHtml = currentOrder.map((item, index) => `
                    <div style="background: #f0f0f0; padding: 1mm; margin-bottom: 1px;">
                        <div>üçõ ${item.name}</div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>${item.quantity} x Rp ${item.price.toLocaleString('id-ID')}</span>
                            <span>Rp ${(item.quantity * item.price).toLocaleString('id-ID')}</span>
                        </div>
                    </div>
                    ${index < currentOrder.length - 1 ? '<div style="border-bottom: 1px dashed #000; margin: 1mm 0;"></div>' : ''}
                `).join('');
            } else if (currentReceiptDesign === 'colorful') {
                itemsHtml = currentOrder.map((item, index) => `
                    <div style="background: #ccffcc; padding: 1mm; margin-bottom: 1px;">
                        <div>üçõ ${item.name}</div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>${item.quantity} porsi</span>
                            <span>Rp ${(item.quantity * item.price).toLocaleString('id-ID')}</span>
                        </div>
                    </div>
                    ${index < currentOrder.length - 1 ? '<div style="border-bottom: 1px dashed #000; margin: 1mm 0;"></div>' : ''}
                `).join('');
            } else if (currentReceiptDesign === 'retro') {
                itemsHtml = currentOrder.map((item, index) => `
                    <div>‚ñ∫ ${item.name}</div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>  ${item.quantity} x ${item.price.toLocaleString('id-ID')}</span>
                        <span>${(item.quantity * item.price).toLocaleString('id-ID')} ‚óÑ</span>
                    </div>
                    ${index < currentOrder.length - 1 ? '<div style="font-size: 8px; text-align: center;">‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí‚ñí</div>' : ''}
                `).join('');
            } else if (currentReceiptDesign === 'professional') {
                itemsHtml = currentOrder.map((item, index) => `
                    <div>${item.name}</div>
                    <div style="display: flex; justify-content: space-between;">
                        <span>${item.quantity} x Rp ${item.price.toLocaleString('id-ID')}</span>
                        <span>Rp ${(item.quantity * item.price).toLocaleString('id-ID')}</span>
                    </div>
                    ${index < currentOrder.length - 1 ? '<div style="border-bottom: 1px solid #ccc; margin: 1mm 0;"></div>' : ''}
                `).join('');
            } else if (currentReceiptDesign === 'cute') {
                itemsHtml = currentOrder.map((item, index) => `
                    <div style="text-align: center; background: #ffe6f2; padding: 1mm;">
                        <div>üçõ ${item.name} üçõ</div>
                        <div style="display: flex; justify-content: space-between;">
                            <span>${item.quantity} porsi x Rp ${item.price.toLocaleString('id-ID')}</span>
                            <span>Rp ${(item.quantity * item.price).toLocaleString('id-ID')}</span>
                        </div>
                    </div>
                    ${index < currentOrder.length - 1 ? '<div style="font-size: 8px; text-align: center;">‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶‚Ä¢‚óè‚óâ‚úø‚óâ‚óè‚Ä¢‚ó¶</div>' : ''}
                `).join('');
            } else if (currentReceiptDesign === 'tech') {
                itemsHtml = currentOrder.map((item, index) => `
                    <div>‚îÇ ITEM: ${item.name.replace(/\s/g, '_')}</div>
                    <div>‚îÇ QTY: ${item.quantity} PRICE: ${item.price}</div>
                    <div>‚îÇ SUBTOTAL: ${item.quantity * item.price}</div>
                    ${index < currentOrder.length - 1 ? '<div style="font-size: 8px; text-align: center;">‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</div>' : ''}
                `).join('');
            } else if (currentReceiptDesign === 'minimalist') {
                itemsHtml = currentOrder.map((item, index) => `
                    <div style="display: flex; justify-content: space-between;">
                        <span>${item.name}</span>
                        <span>${(item.quantity * item.price).toLocaleString('id-ID')}</span>
                    </div>
                    <div style="font-size: 6px; color: #666;">${item.quantity}x</div>
                    ${index < currentOrder.length - 1 ? '<div style="border-bottom: 1px solid #ccc; margin: 1mm 0;"></div>' : ''}
                `).join('');
            } else {
                // Classic and elegant designs
                itemsHtml = currentOrder.map((item, index) => `
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1px;">
                        <span>${item.name}</span>
                    </div>
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1px;">
                        <span>${item.quantity} x Rp ${item.price.toLocaleString('id-ID')}</span>
                        <span>Rp ${(item.quantity * item.price).toLocaleString('id-ID')}</span>
                    </div>
                    ${index < currentOrder.length - 1 ? '<div style="border-bottom: 1px dashed #000; margin: 1mm 0;"></div>' : ''}
                `).join('');
            }
            
            document.getElementById(`receiptItems${suffix}`).innerHTML = itemsHtml;
        }
        
        function updateReceiptFooter(suffix) {
            const footerElement = document.getElementById(`receiptFooter${suffix}`);
            if (!footerElement) return;
            
            let footerHtml = '';
            
            // Apply design-specific styling to footer text
            if (currentReceiptDesign === 'modern') {
                if (footerSettings.line1) footerHtml += `<div>üôè ${footerSettings.line1}</div>`;
                if (footerSettings.line2) footerHtml += `<div>üòä ${footerSettings.line2}</div>`;
                if (footerSettings.line3) footerHtml += `<div>‚ú® ${footerSettings.line3}</div>`;
            } else if (currentReceiptDesign === 'elegant') {
                if (footerSettings.line1) footerHtml += `<div>~ ${footerSettings.line1} ~</div>`;
                if (footerSettings.line2) footerHtml += `<div>~ ${footerSettings.line2} ~</div>`;
                if (footerSettings.line3) footerHtml += `<div>~ ${footerSettings.line3} ~</div>`;
            } else if (currentReceiptDesign === 'colorful') {
                if (footerSettings.line1) footerHtml += `<div>‚ú® ${footerSettings.line1} ‚ú®</div>`;
                if (footerSettings.line2) footerHtml += `<div>üåü ${footerSettings.line2} üåü</div>`;
                if (footerSettings.line3) footerHtml += `<div>‚≠ê ${footerSettings.line3} ‚≠ê</div>`;
            } else if (currentReceiptDesign === 'retro') {
                if (footerSettings.line1) footerHtml += `<div>‚ñë‚ñë ${footerSettings.line1.toUpperCase()} ‚ñë‚ñë</div>`;
                if (footerSettings.line2) footerHtml += `<div>‚ñë‚ñë ${footerSettings.line2.toUpperCase()} ‚ñë‚ñë</div>`;
                if (footerSettings.line3) footerHtml += `<div>‚ñë‚ñë ${footerSettings.line3.toUpperCase()} ‚ñë‚ñë</div>`;
            } else if (currentReceiptDesign === 'cute') {
                if (footerSettings.line1) footerHtml += `<div>‚ú® ${footerSettings.line1} Sayang ‚ú®</div>`;
                if (footerSettings.line2) footerHtml += `<div>üå∏ ${footerSettings.line2} üå∏</div>`;
                if (footerSettings.line3) footerHtml += `<div>üíñ ${footerSettings.line3} üíñ</div>`;
            } else if (currentReceiptDesign === 'tech') {
                if (footerSettings.line1) footerHtml += `<div>>>> ${footerSettings.line1.toUpperCase().replace(/\s/g, '_')} <<<</div>`;
                if (footerSettings.line2) footerHtml += `<div>>>> ${footerSettings.line2.toUpperCase().replace(/\s/g, '_')} <<<</div>`;
                if (footerSettings.line3) footerHtml += `<div>>>> ${footerSettings.line3.toUpperCase().replace(/\s/g, '_')} <<<</div>`;
            } else {
                // Classic, minimalist, and professional designs
                if (footerSettings.line1) footerHtml += `<div>${footerSettings.line1}</div>`;
                if (footerSettings.line2) footerHtml += `<div>${footerSettings.line2}</div>`;
                if (footerSettings.line3) footerHtml += `<div>${footerSettings.line3}</div>`;
            }
            
            footerElement.innerHTML = footerHtml;
        }
        
        function showNotification(message, type = 'info') {
            // Create notification element
            const notification = document.createElement('div');
            notification.className = `fixed top-4 right-4 p-4 rounded-lg shadow-lg z-50 ${
                type === 'error' ? 'bg-red-500 text-white' : 
                type === 'success' ? 'bg-green-500 text-white' : 
                'bg-blue-500 text-white'
            }`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            // Remove after 3 seconds
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }
        
        async function printToBluetooth(receiptText) {
            if (!bluetoothCharacteristic) {
                throw new Error('Printer tidak terhubung');
            }
            
            try {
                // Simple text-based printing for better compatibility
                const encoder = new TextEncoder();
                
                // Build complete receipt text with centered header
                let fullReceipt = '';
                
                // Center the business name (assuming 32 char width)
                const centerText = (text, width = 32) => {
                    const padding = Math.max(0, Math.floor((width - text.length) / 2));
                    return ' '.repeat(padding) + text;
                };
                
                fullReceipt += centerText(businessSettings.name) + '\n';
                fullReceipt += centerText(businessSettings.address) + '\n';
                fullReceipt += centerText(`Telp: ${businessSettings.phone}`) + '\n';
                fullReceipt += '--------------------------------\n';
                fullReceipt += receiptText;
                fullReceipt += '--------------------------------\n';
                fullReceipt += centerText('Terima Kasih') + '\n';
                fullReceipt += centerText('Selamat Menikmati!') + '\n\n\n\n';
                
                // Convert to bytes
                const data = encoder.encode(fullReceipt);
                
                // Send data in chunks to avoid buffer overflow
                const chunkSize = 20; // Small chunks for better compatibility
                for (let i = 0; i < data.length; i += chunkSize) {
                    const chunk = data.slice(i, i + chunkSize);
                    
                    if (bluetoothCharacteristic.properties.writeWithoutResponse) {
                        await bluetoothCharacteristic.writeValueWithoutResponse(chunk);
                    } else {
                        await bluetoothCharacteristic.writeValue(chunk);
                    }
                    
                    // Small delay between chunks
                    await new Promise(resolve => setTimeout(resolve, 100));
                }
                
            } catch (error) {
                console.error('Print error:', error);
                throw new Error(`Gagal mencetak: ${error.message}`);
            }
        }
        
        async function printReceipt() {
            const subtotal = currentOrder.reduce((sum, item) => sum + (item.price * item.quantity), 0);
            const tax = Math.round(subtotal * 0.1);
            const total = subtotal + tax;
            const cashReceived = parseInt(document.getElementById('cashReceived').value) || 0;
            const change = cashReceived - total;
            const transactionId = generateTransactionId();
            
            // Get custom date and time
            const customDate = document.getElementById('transactionDate').value;
            const customTime = document.getElementById('transactionTime').value;
            
            let displayDate, displayTime;
            if (customDate) {
                const dateObj = new Date(customDate);
                displayDate = dateObj.toLocaleDateString('id-ID');
            } else {
                displayDate = new Date().toLocaleDateString('id-ID');
            }
            
            if (customTime) {
                displayTime = customTime;
            } else {
                displayTime = new Date().toLocaleTimeString('id-ID');
            }
            
            try {
                // If Bluetooth printer is connected, use it
                if (bluetoothCharacteristic) {
                    
                    // Build receipt text
                    let receiptText = `No. Transaksi: ${transactionId}\n`;
                    receiptText += `Tanggal: ${displayDate}\n`;
                    receiptText += `Waktu: ${displayTime}\n`;
                    receiptText += `Kasir: ${businessSettings.cashier}\n\n`;
                    
                    // Add items with separators
                    currentOrder.forEach((item, index) => {
                        receiptText += `${item.name}\n`;
                        receiptText += `${item.quantity} x Rp ${item.price.toLocaleString('id-ID')} = Rp ${(item.quantity * item.price).toLocaleString('id-ID')}\n`;
                        if (index < currentOrder.length - 1) {
                            receiptText += '- - - - - - - - - - - - - - - -\n';
                        }
                    });
                    
                    receiptText += `\nSubtotal: Rp ${subtotal.toLocaleString('id-ID')}\n`;
                    receiptText += `Pajak Pemda (10%): Rp ${tax.toLocaleString('id-ID')}\n`;
                    receiptText += `TOTAL: Rp ${total.toLocaleString('id-ID')}\n`;
                    receiptText += `Bayar: Rp ${cashReceived.toLocaleString('id-ID')}\n`;
                    receiptText += `Kembali: Rp ${change.toLocaleString('id-ID')}\n\n`;
                    
                    await printToBluetooth(receiptText);
                    showNotification('Struk berhasil dicetak via Bluetooth!', 'success');
                } else {
                    // Fallback to browser print with selected design
                    updateReceiptTemplate(transactionId, displayDate, displayTime, subtotal, tax, total, cashReceived, change);
                    
                    // Show selected receipt template and print
                    const templateId = getReceiptTemplateId();
                    document.getElementById(templateId).classList.remove('hidden');
                    window.print();
                    
                    setTimeout(() => {
                        document.getElementById(templateId).classList.add('hidden');
                    }, 1000);
                    
                    showNotification('Struk dicetak via browser. Hubungkan printer Bluetooth untuk cetak langsung.', 'info');
                }
                
                // Clean up after printing
                closePaymentModal();
                currentOrder = [];
                renderOrder();
                
            } catch (error) {
                console.error('Print failed:', error);
                showNotification('Gagal mencetak struk. Coba hubungkan ulang printer.', 'error');
            }
        }
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'991ce48cc2909ca7',t:'MTc2MTAwOTIxMC4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
